<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global News Map - GeopolMonitor üåç</title>
    <link rel="stylesheet" href="/static/css/modules/base.css">
    <link rel="stylesheet" href="/static/css/modules/theme.css">
    <link rel="stylesheet" href="/static/css/modules/map.css">
    <link rel="stylesheet" href="/static/css/modules/heatmap.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üåç</text></svg>">
    
    <!-- Initialize theme -->
    <script>
        const savedTheme = localStorage.getItem('theme') || 'dark';
        document.documentElement.setAttribute('data-theme', savedTheme);
        document.documentElement.style.setProperty('--legend-gradient', 'linear-gradient(to right, rgba(64, 115, 255, 0.5), rgba(19, 49, 143, 0.9))');
    </script>
    
    <!-- Load Leaflet and plugins -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
</head>
<body>
    <header>
        <div class="header-left">
            <a href="/" class="nav-brand">GeopolMonitor üåç</a>
            <nav class="main-nav">
                <a href="/" class="nav-link">News</a>
                <a href="/map" class="nav-link active">Map</a>
                <a href="/about" class="nav-link">About</a>
            </nav>
        </div>
        <div class="header-controls">
            <button id="themeToggle" class="theme-toggle" title="Toggle theme">
                <i class="fas fa-sun"></i>
            </button>
            <div class="live-indicator">
                <span class="pulse"></span>
                <span>LIVE</span>
            </div>
        </div>
    </header>

    <main class="map-page">
        <div class="map-info">
            <h1>Global News Map</h1>
            <p>Real-time visualization of news events across the globe. The intensity of colors indicates the density of news coverage in each region.</p>
            <div class="map-stats">
                <div class="stat-item">
                    <span id="activeRegions" class="stat-value">0</span>
                    <span class="stat-label">Active Regions</span>
                </div>
                <div class="stat-item">
                    <span id="todayEvents" class="stat-value">0</span>
                    <span class="stat-label">Today's Events</span>
                </div>
            </div>
        </div>

        <div class="map-wrapper">
            <div class="map-container">
                <div id="worldMap"></div>
                <div class="country-news-panel" style="display: none;">
                    <div class="country-news-header">
                        <h2><span class="country-flag"></span> <span id="selectedCountry">Country</span></h2>
                        <button class="close-btn" id="closeCountryNews" title="Close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="country-news-list" id="countryNewsList">
                        <!-- News items will be populated here -->
                    </div>
                </div>
            </div>
            <div class="map-controls">
                <div class="timeline-container">
                    <label for="timelineSlider">News Activity Timeline</label>
                    <input type="range" id="timelineSlider" class="timeline-slider" 
                           min="1" max="30" value="7" step="1">
                    <div class="slider-info">
                        <span class="slider-hint">Recent news ‚Üí</span>
                        <span id="daysValue">Last 7 days</span>
                        <span class="slider-hint">‚Üê Older news</span>
                    </div>
                    <div class="timeline-help">
                        Drag the slider to adjust the time range of news activity shown on the map
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script type="module" src="/static/js/modules/countries.js"></script>
    <script type="module" src="/static/js/modules/map-styles.js"></script>
    <script type="module" src="/static/js/modules/map.js"></script>
    <script type="module" src="/static/js/map-page.js"></script>
</body>
</html>